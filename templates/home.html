{% extends "base.html" %}
{% from "macros.html" import translate with context %}

{% block content %}
<div class="panel">
  <h1 class="mb-4">ğŸ  {{ translate("Dashboard") }}</h1>

  <p>
    {{ translate("Welcome") }}, <strong>{{ nickname }}</strong>!
  </p>

  {% if nickname == "ADMIN" %}
    <h2>{{ translate("Overall stats") }}</h2>
    <p>
      {{ translate("Total users:") }} {{ totale_utenti }}<br>
      {{ translate("Average score:") }} {{ media_punti }}
    </p>
    
    <a href="{{ url_for('gestione_utenti') }}" class="btn btn-outline-success my-3">
      ğŸ‘¥ {{ translate("User Management") }}
    </a>

    <h4>{{ translate("Recently rewarded (last 7 days)") }}</h4>
    <ul>
      {% for n in premiati_recenti %}
        <li>{{ n }}</li>
      {% endfor %}
    </ul>
  {% else %}
    <h2>{{ translate("Your progress") }}</h2>
    <p>
      {{ translate("Points collected:") }} <strong>{{ punti }}</strong><br>
      {{ translate("Points to prize:")}} <strong>{{ punti_mancanti }}</strong><br>
      {{ translate("Completion:") }} <strong>{{ percentuale }}%</strong>
    </p>
    <a href="{{ url_for('Robiettivi') }}" class="btn btn-primary">
      {{ translate("View Goals") }}
    </a>
    {% if punti >= 120 %}
      <div class="alert alert-success text-center mt-4" role="alert">
        <h4 class="alert-heading">ğŸ‰ Complimenti!</h4>
        <p>Hai diritto al premio per aver raggiunto l'obiettivo di 120 punti!</p>
        <img src="{{ url_for('static', filename='img/premio.png') }}" alt="Premio" style="width:150px;">
      </div>
{% endif %}

  {% endif %}

  <div class="mt-4">
    <a href="{{ url_for('logout') }}" class="btn btn-outline-danger">
      {{ translate("Logout") }}
    </a>
  </div>
</div>
{% endblock %}
